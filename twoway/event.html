<!DOCTYPE html>
<html>
<head lang="ko">
    <meta charset="UTF-8">
    <title></title>
</head>
<body>

    <div data-event-click="sayHello('why?')">이벤트 바인딩 테스트</div>

    <script>

        (function(exports) {

            //"use strict";

            var cache = {};
            function bind(listeners, el) {
                events.forEach(function(eventType) {
                    var bindable = (el || document).querySelectorAll('[data-event-'+ eventType +']'),
                        arr = Array.prototype.slice.call(bindable);
                    arr.forEach(function(el) {
                        var dataSet = el.dataset['event' + eventType.charAt(0).toUpperCase() + eventType.substr(1)].trim();
                        el.addEventListener(eventType, function(e) {
                            //eval("listeners." + dataSet);
                            with(listeners) {
                                eval(dataSet);
                            }
                        }, false);
                    });
                });
            }

            var events = [ 'click', 'change' ]
            exports.autoBind = bind;

        })(this);

        (function(global) {

            global.addEventListener("load", function(e) {

                autoBind({
                    sayHello: function(val) {
                        alert(val);
                    }
                });

            });

        })(this);

    </script>

</body>
</html>